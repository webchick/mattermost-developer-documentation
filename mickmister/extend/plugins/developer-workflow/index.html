<!DOCTYPE html>





<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> Developer Workflow</title>
<meta name="viewport" content="width=device-width, initial-scale=1">   
<meta http-equiv="content-language" content="en-us" />



<link rel="canonical" href="../../../extend/plugins/developer-workflow/">


<link rel="shortcut icon" type="image/png" href="../../../img/favicon-32x32.png" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet">


<link rel="stylesheet" href="../../../css/bootstrap.min.css">
<link rel="stylesheet" href="../../../css/tabs.css">
<link rel="stylesheet" href="../../../css/bar.css">
<link rel="stylesheet" href="../../../css/styles.css">
<link rel="stylesheet" href="../../../css/code.css">
<link rel="stylesheet" href="../../../css/note.css">


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="../../../js/tabs.js"></script>
<script src="../../../js/main.js"></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>
<script async src="//cdn.bizible.com/scripts/bizible.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-64458817-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-64458817-2');
</script>


<script type="text/javascript">
    (function() {
    var didInit = false;
    function initMunchkin() {
    if(didInit === false) {
    didInit = true;
    Munchkin.init('161-FBE-733');
    }
    }
    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
    initMunchkin();
    }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>


<script type="text/javascript" charset="utf-8">
    var _eiq = _eiq || [];
    var _engagio_settings = {
      accountId: "cb6a404b72e9141b70d1f82abc04db92b4e56238"
    };
    (function() {
      var ei = document.createElement('script'); ei.type = 'text/javascript'; ei.async = true;
      ei.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'web-analytics.engagio.com/js/ei.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ei, s);
    })();
  </script>

    </head>
<body>
    <header>
    <a href="../../../"><img src="../../../img/logo.svg" alt="Mattermost Logo" width="212px"></a>
    <div class="header__menu-toggle">
        <i class="fa fa-bars"></i>
    </div>
    <ul class="header__links--right">
        <li><a href="../../../">Home</a></li>
        
            
            
            
                
                    <li><a href="../../../contribute/getting-started">Contribute</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../integrate/getting-started">Integrate</a></li>
                
            
        
            
            
            
                
                    <li class="active"><a href="../../../extend/getting-started">Extend</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../blog">Blog</a></li>
                
            
        
            
            
            
                
                    <li><a href="https://docs.mattermost.com/">Admin Docs</a></li>
                
            
        
    </ul>
</header>




    <div id="wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-3 sidebar">
    <div class="sidebar__menu-toggle">
        Developer Workflow
        <i class="fa fa-bars pull-right"></i>
    </div>
    <div class="row sidebar__links">
        
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../extend/getting-started/"> Getting Started</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../extend/customization/"> Customizing Mattermost</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/customization/server-build/"> Server Build (Team Edition)</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/customization/server-files/"> Server Files</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/customization/webapp/"> Web App</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../extend/plugins/"> Plugins (Beta)</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/overview/"> Overview</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/developer-setup/"> Developer Setup</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        
                            
                        

                        
                            
                        

                        <span class="item active">
                            <i class="sub-menu__toggle fa fa-minus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a class="active" href="../../../extend/plugins/developer-workflow/"> Developer Workflow</a></span>
                            
                        </span>
                        <ul class="sub-menu" style="display: block">
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                            
                                <a href="../../../extend/plugins/server/"> Server Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                                <a class="item " href="../../../extend/plugins/server/hello-world/">Quick Start</a>
                            
                                <a class="item " href="../../../extend/plugins/server/reference/">Server Reference</a>
                            
                                <a class="item " href="../../../extend/plugins/server/ha/">High Availability</a>
                            
                                <a class="item " href="../../../extend/plugins/server/debugging/"></a>
                            
                                <a class="item " href="../../../extend/plugins/server/best-practices/">Best Practices</a>
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                            
                                <a href="../../../extend/plugins/webapp/"> Web App Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                                <a class="item " href="../../../extend/plugins/webapp/hello-world/">Quick Start</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/reference/">Web App Reference</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/actions/">Redux Actions</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/best-practices/">Design Best Practices</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/proper-configuration/">Proper Configuration</a>
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/manifest-reference/"> Manifest Reference</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/mobile/"> Mobile Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/example-plugins/"> Example Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/migration/"> Migrating Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/community_process/"> Process to Include Plugin on Community</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/community-plugin-marketplace/"> Community Plugins in the Marketplace</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/best-practices/"> Best Practices</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/helpers/"> Plugin Helpers</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../extend/embed/"> Embed</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
        
    </div>
</div>

                <div class="col-lg-9 doc-content">
                    
<a href="https://github.com/mattermost/mattermost-developer-documentation/edit/master/site/content/extend/plugins/developer-workflow.md" class="float-right edit-github">
    Edit on GitHub
</a>


                    <h1 class="mt-0 doc-title">
                        Developer Workflow
                    </h1>
                    <h3 id="common-make-commands">Common <code>make</code> commands&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#common-make-commands"></i></a> </h3>
<ul>
<li><code>make dist</code> - Compile the plugin into a g-zipped file, ready to upload to a Mattermost server. The file is saved in the plugin repo&rsquo;s <code>dist</code> folder.</li>
<li><code>make deploy</code> - Compiles the plugin using the <code>make dist</code> command, then automatically deploys the plugin to the Mattermost server</li>
<li><code>make watch</code> - Uses webpack&rsquo;s watch feature to re-compile and deploy the webapp portion of your plugin on any change to the <code>webapp/src</code> folder</li>
<li><code>make test</code> - Runs the plugin&rsquo;s server tests and webapp tests</li>
<li><code>make check-style</code> - Runs linting checks on the plugin&rsquo;s server and webapp folders</li>
<li><code>make enable</code> - Enables the plugin on the Mattermost server</li>
<li><code>make disable</code> - Disables the plugin on the Mattermost server</li>
<li><code>make reset</code> - Disables and re-enables the plugin on the Mattermost server</li>
<li><code>make debug-plugin</code> - Starts a <code>delve</code> process and attaches it to your running plugin</li>
</ul>
<p>You can run the development build of the plugin by setting the environment variable <code>MM_DEBUG=1</code>, or prefixing the variable at the beginning of the <code>make</code> command. For example, <code>MM_DEBUG=1 make deploy</code> will deploy the development build of the plugin to your server, allowing you to have a more fluid debugging experience. To use the production build of the plugin instead, unset the <code>MM_DEBUG</code> environment variable before running the <code>make</code> commands.</p>
<h3 id="exposing-the-mattermost-server-using-ngrok">Exposing the Mattermost server using <code>ngrok</code>&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#exposing-the-mattermost-server-using-ngrok"></i></a> </h3>
<p>When a public integrates with an external service, webhooks and/or authentication redirects are necessary, which requires your local server to be available on the web. In order for your Mattermost server to be available to process webhook requests, it needs to expose its port to an external address. A common way to do this is to use the command line tool <a href="https://ngrok.com">ngrok</a>. Follow these steps to set up <code>ngrok</code> with your server:</p>
<ul>
<li>Download the <code>ngrok</code> tool from <a href="https://ngrok.com/download">here</a></li>
<li>Put the executable somewhere within your shell&rsquo;s <code>PATH</code>.</li>
<li>Run <code>ngrok http 8065</code> to make your Mattermost server available for webhook requests.</li>
<li>Set your Mattermost server&rsquo;s <a href="http://localhost:8065/admin_console/environment/web_server">Site URL</a> to the <code>https</code> address given from the <code>ngrok</code> command output.</li>
<li>Monitor incoming webhook requests with ngrok&rsquo;s request inspector. Visit <a href="http://localhost:4040">http://localhost:4040</a> once you have your tunnel open. You can analyze the contents of the HTTP request from the external service, and the response from your plugin.</li>
</ul>
<p>If you&rsquo;re using a free ngrok account, the URL given by the output of the <code>ngrok http</code> command will be different each time you run the command. As a result, you&rsquo;ll need to adjust the webhook URL on Mattermost&rsquo;s side and the external service&rsquo;s side (e.g. GitHub) each time you run the command.</p>
<p>With this setup, many integrations require you to be logged into Mattermost using your ngrok URL. After logging into your ngrok URL pointed to your Mattermost server, in most cases you can continue using your localhost address in your browser for quicker network requests to your server. If you receive an error like <code>unauthorized</code> or <code>enable third-party cookies</code> when connecting to an external service, make sure you&rsquo;re logged into your ngrok URL in the same browser.</p>
<h3 id="debugging-server-side-plugins-using-delve">Debugging server-side plugins using <code>delve</code>&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#debugging-server-side-plugins-using-delve"></i></a> </h3>
<p>Using the <code>make debug-plugin</code> command will allow you to use a debugger and step through the plugin&rsquo;s server code. A <a href="https://github.com/go-delve/delve">delve</a> process will be created and attach to your plugin. You can then use an IDE or debug console to connect to the <code>delve</code> process. If you are using VSCode, you can use this <code>launch.json</code> configuration to connect.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;Attach remote&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;go&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;request&#34;</span>: <span style="color:#c30">&#34;attach&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;mode&#34;</span>: <span style="color:#c30">&#34;remote&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;port&#34;</span>: <span style="color:#f60">2346</span>,
    <span style="color:#309;font-weight:bold">&#34;host&#34;</span>: <span style="color:#c30">&#34;127.0.0.1&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;apiVersion&#34;</span>: <span style="color:#f60">2</span>
}
</code></pre></div><p>If the debugger is paused for more than 5 seconds, the RPC connection with the server times out. The server cannot communicate with the plugin anymore, so the plugin then needs to be restarted.</p>
<p>In order to be able to pause the debugger for more than 5 seconds, two modifications need to be done to the <code>mattermost-server</code> repository:</p>
<ol>
<li>
<p>The plugin health check job needs to be disabled. This can be done by commenting out the <code>go job.run()</code> line in <a href="https://github.com/mattermost/mattermost-server/blob/master/plugin/environment.go#L510">mattermost-server/plugin/environment.go</a>. Note that if your plugin crashes, you&rsquo;ll need to restart it, using <code>make reset</code> for example. This will also kill any currently running <code>delve</code> process. If you want to continue debugging with <code>delve</code>, you&rsquo;ll need to run <code>make debug-plugin</code> again after restarting the plugin.</p>
</li>
<li>
<p>The <code>go-plugin</code>'s RPC client needs to be configured with a larger timeout duration. You can change the code at <a href="https://github.com/mattermost/mattermost-server/blob/bf03f391e635b0b9b129768cec5ea13c571744fa/vendor/github.com/hashicorp/go-plugin/rpc_client.go#L63">mattermost-server/vendor/github.com/hashicorp/rpc_client.go</a> to increase the duration. Here&rsquo;s the change you can make to extend the timeout to 5 minutes:</p>
</li>
</ol>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">sessionConfig <span style="color:#555">:=</span> yamux.<span style="color:#c0f">DefaultConfig</span>()
sessionConfig.EnableKeepAlive = <span style="color:#069;font-weight:bold">true</span>
sessionConfig.ConnectionWriteTimeout = time.Minute <span style="color:#555">*</span> <span style="color:#f60">5</span>

mux, err <span style="color:#555">:=</span> yamux.<span style="color:#c0f">Client</span>(conn, sessionConfig)
</code></pre></div>

                </div>
            </div>
        </div>
    </div>
    <footer class="text-center">
    <div class="container-fluid">
        <div class="footer__copyright">© Mattermost, Inc. All Rights Reserved.</div>
        <div class="footer__icons">
            <a href="https://www.facebook.com/Mattermost-2300985916642531/"><i class="fa fa-facebook"></i></a>
            <a href="https://twitter.com/mattermost"><i class="fa fa-twitter"></i></a>
            <a href="https://www.youtube.com/channel/UCNR05H72hi692y01bWaFXNA"><i class="fa fa-youtube"></i></a>
        </div>
    </div>
</footer>

</body>
</html>
