<!DOCTYPE html>





<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> VPN(CLOUD)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">   
<meta http-equiv="content-language" content="en-us" />



<link rel="canonical" href="../../../internal/infrastructure/vpn-cloud/">


<link rel="shortcut icon" type="image/png" href="../../../img/favicon-32x32.png" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet">


<link rel="stylesheet" href="../../../css/bootstrap.min.css">
<link rel="stylesheet" href="../../../css/tabs.css">
<link rel="stylesheet" href="../../../css/bar.css">
<link rel="stylesheet" href="../../../css/styles.css">
<link rel="stylesheet" href="../../../css/code.css">
<link rel="stylesheet" href="../../../css/note.css">


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="../../../js/tabs.js"></script>
<script src="../../../js/main.js"></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>
<script async src="//cdn.bizible.com/scripts/bizible.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-64458817-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-64458817-2');
</script>


<script type="text/javascript">
    (function() {
    var didInit = false;
    function initMunchkin() {
    if(didInit === false) {
    didInit = true;
    Munchkin.init('161-FBE-733');
    }
    }
    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
    initMunchkin();
    }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>


<script type="text/javascript" charset="utf-8">
    var _eiq = _eiq || [];
    var _engagio_settings = {
      accountId: "cb6a404b72e9141b70d1f82abc04db92b4e56238"
    };
    (function() {
      var ei = document.createElement('script'); ei.type = 'text/javascript'; ei.async = true;
      ei.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'web-analytics.engagio.com/js/ei.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ei, s);
    })();
  </script>

    </head>
<body>
    <header>
    <a href="../../../"><img src="../../../img/logo.svg" alt="Mattermost Logo" width="212px"></a>
    <div class="header__menu-toggle">
        <i class="fa fa-bars"></i>
    </div>
    <ul class="header__links--right">
        <li><a href="../../../">Home</a></li>
        
            
            
            
                
                    <li><a href="../../../contribute/getting-started">Contribute</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../integrate/getting-started">Integrate</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../extend/getting-started">Extend</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../blog">Blog</a></li>
                
            
        
            
            
            
                
                    <li><a href="https://docs.mattermost.com/">Admin Docs</a></li>
                
            
        
    </ul>
</header>




    <div id="wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-3 sidebar">
    <div class="sidebar__menu-toggle">
        VPN(CLOUD)
        <i class="fa fa-bars pull-right"></i>
    </div>
    <div class="row sidebar__links">
        
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../internal/infrastructure/"> Infrastructure</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                            
                                <a href="../../../internal/infrastructure/kubernetes/"> Kubernetes</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                                <a class="item " href="../../../internal/infrastructure/kubernetes/kubernetes-troubleshooting/">Kubernetes Maintenance</a>
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/grafana/"> Community Grafana</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        
                            
                        

                        
                            
                        

                        <span class="item active">
                            <i class="sub-menu__toggle fa fa-minus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a class="active" href="../../../internal/infrastructure/vpn-cloud/"> VPN(CLOUD)</a></span>
                            
                        </span>
                        <ul class="sub-menu" style="display: block">
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/vpn/"> VPN</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/vault/"> Vault</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/plugins/"> Adding a Plugin to Community</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/aws/"> AWS</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/onelogin-aws/"> OneLogin and AWS</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/build/"> Build</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/infrastructure/guidelines/"> Guidelines for New Infrastructure</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/qa/"> QA</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/offboarding/"> Offboarding</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../internal/onboarding/"> Onboarding</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/onboarding/new-staff-guide/"> New Staff Guide</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/onboarding/manager-guide/"> Manager Guide</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../internal/mobile-build-process/"> Mobile Build Process</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/mobile-build-process/bump-version-number/"> Bump Version Number</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/mobile-build-process/bump-build-number/"> Bump Build Number</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../internal/mobile-build-process/troubleshooting/"> Troubleshooting</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/release-tagging-process/"> Release Tagging Process</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/release-process/"> Release Cutting Process</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/plugin-release-process/"> Plugin Release Process</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/tips-and-best-practices/"> Tips and Best Practices</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/writing-a-blog-post/"> Writing a Blog Post</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/rd-teams/"> R&amp;D Teams</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../internal/sustained-engineering/"> Sustained Engineering Team</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
        
    </div>
</div>

                <div class="col-lg-9 doc-content">
                    
<a href="https://github.com/mattermost/mattermost-developer-documentation/edit/master/site/content/internal/infrastructure/vpn-cloud.md" class="float-right edit-github">
    Edit on GitHub
</a>


                    <h1 class="mt-0 doc-title">
                        VPN(CLOUD)
                    </h1>
                    <p>Table of contents</p>
<ul>
<li><a href="#setup-vpn-access-on-pritunl">Setup VPN access on Pritunl</a>
<ul>
<li><a href="#viscosity-client">Viscosity client</a></li>
<li><a href="#pritunl-client">Pritunl client</a></li>
</ul>
</li>
<li><a href="#older-setup-of-vpn-access-on-openvpn">Older Setup of VPN access on OpenVPN</a></li>
</ul>
<h2 id="setup-vpn-access-on-pritunl">Setup VPN access on Pritunl&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#setup-vpn-access-on-pritunl"></i></a> </h2>
<h3 id="viscosity-client">Viscosity client&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#viscosity-client"></i></a> </h3>
<ol>
<li>Install a VPN client that supports DNS settings such as Visocity.</li>
</ol>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">brew cask install viscosity
</code></pre></div><ol start="2">
<li>
<p>Go to the <a href="https://pritunl.core.cloud.mattermost.com">VPN server</a> and select <strong>Sign in with OneLogin</strong>.
Then connect with your OneLogin username and password and when prompt put the OTP (One Time Password).
Select <code>Show More</code> and hit <code>Download Profile</code>
<span style="display:block;text-align:center;width:40%"><img src="../../../img/vpn_cloud_4.png" alt="Pritunl User Profiles"></span></p>
</li>
<li>
<p>Open the Viscosity application or your preferred VPN client and go to settings/preferences.</p>
</li>
<li>
<p>Click + to import the profile you downloaded from the VPN server on the step 1
<span style="display:block;text-align:center;width:50%"><img src="../../../img/vpn_cloud_2.png" alt="Viscosity Profile Add"></span></p>
</li>
<li>
<p>After your profile is imported, select to edit the entry,</p>
</li>
</ol>
<ul>
<li>
<p>On the General tab update the Address of the Remote Server to be: <code>pritunl.core.cloud.mattermost.com</code> as shown below:
<span style="display:block;text-align:center;width:50%"><img src="../../../img/vpn_cloud_5.jpg" alt="General settings Viscosity"></span></p>
</li>
<li>
<p>Go to Networking tab and update the DNS settings.</p>
<ul>
<li>Select for the Mode to be <code>Split DNS</code>.</li>
<li>As <code>Servers</code> put: <code>pritunl.core.cloud.mattermost.com</code> which is VPN&rsquo;s server IP.</li>
<li>In <code>Domains</code> put: <code>cloud.mattermost.com</code>, this will split traffic for those domains
<span style="display:block;text-align:center;width:50%"><img src="../../../img/vpn_cloud_6.jpg" alt="Network settings Viscosity"></span></li>
</ul>
</li>
</ul>
<ol start="6">
<li>After following these steps you should be able to connect to VPN and then to resolve private DNS entries.</li>
</ol>
<h3 id="pritunl-client">Pritunl client&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#pritunl-client"></i></a> </h3>
<ol>
<li>
<p>Go to the <a href="https://pritunl.core.cloud.mattermost.com">VPN server</a> and select <strong>Sign in with OneLogin</strong>
Then connect with your OneLogin username and password and when prompt put the OTP (One Time Password).</p>
</li>
<li>
<p>Select <code>Download Client</code> which will redirect you to download the Pritunl Client.</p>
<p>Select your OS, download and install the appropriate client.
<span style="display:block;text-align:center;width:40%"><img src="../../../img/vpn_cloud_7.jpg" alt="Pritunl Download Client"></span></p>
</li>
<li>
<p>Go back to browser and copy the <code>Profile URI link</code>
<span style="display:block;text-align:center;width:40%"><img src="../../../img/vpn_cloud_8.jpg" alt="Pritunl Download Client"></span></p>
</li>
<li>
<p>Open the Pritunl client and paste the <code>Profile URI link</code> from previous step
into <code>Import Profile URI</code>
<span style="display:block;text-align:center;width:40%"><img src="../../../img/vpn_cloud_9.jpg" alt="Pritunl import URI"></span></p>
</li>
<li>
<p>Click the burger button on the newly imported profile and select <code>Edit Config</code>
<span style="display:block;text-align:center;width:40%"><img src="../../../img/vpn_cloud_10.jpg" alt="Pritunl Config"></span></p>
</li>
<li>
<p>On the config change the line that says:</p>
<p><code>remote X.XXX.XXX.XX 1194 UDP</code> to be:</p>
<p><code>remote pritunl.core.cloud.mattermost.com 1194 UDP</code></p>
<p><strong>NOTE:</strong> Do NOT change the port, it will be either 1194, 1195 or something else
<span style="display:block;text-align:center;width:50%"><img src="../../../img/vpn_cloud_11.jpg" alt="Pritunl Config remote"></span></p>
</li>
<li>
<p>After following these steps you should be able to connect to VPN and resolve private DNS entries.</p>
</li>
</ol>
<h2 id="gnome-vpn-client">Gnome VPN Client&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#gnome-vpn-client"></i></a> </h2>
<ol>
<li>
<p>Go to the <a href="https://pritunl.core.cloud.mattermost.com">VPN server</a> and select <strong>Sign in with OneLogin</strong>.</p>
</li>
<li>
<p>Connect with your OneLogin username and password and when prompted input the OTP (One Time Password).</p>
</li>
<li>
<p>Click <code>Download Profiles</code> and save the <code>.tar</code> file to your filesystem.</p>
</li>
<li>
<p>Extract the <code>.tar</code> file (<code>tar xf yourusername.tar</code>) and note the location of the <code>.ovpn</code> file.</p>
</li>
<li>
<p>Open the Gnome Settings manager and navigate to <strong>Network &gt; VPN</strong>. Click the <code>+</code> to create a new VPN connection.</p>
</li>
<li>
<p>Choose <strong>Import from file&hellip;</strong>.</p>
</li>
<li>
<p>Select the <code>.ovpn</code> file downloaded earlier through the file picker.</p>
</li>
<li>
<p>Open the <strong>IPv4</strong> tab and select <strong>Use this connection only for resources on its network</strong>.</p>
</li>
<li>
<p>Open the <strong>IPv6</strong> tab and select <strong>Use this connection only for resources on its network</strong>.</p>
</li>
<li>
<p>If desired, rename the VPN to something friendlier in <strong>Identity &gt; Name</strong>.</p>
</li>
<li>
<p>Choose <strong>Add</strong> to save the configuration.</p>
</li>
<li>
<p>From now on, enable the VPN through the taskbar picker in the upper right corner of Gnome.</p>
</li>
</ol>
<h2 id="older-setup-of-vpn-access-on-openvpn">Older Setup of VPN access on OpenVPN&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#older-setup-of-vpn-access-on-openvpn"></i></a> </h2>
<ol>
<li>
<p>Login to the <a href="https://vpn.cloud.mattermost.com">VPN server</a> using your mattermost email and OneLogin password. Please select <code>connect</code> instead of <code>login</code> on the drop down menu.</p>
<ul>
<li>If login fails, ask Cloud team to check if your username is in the correct group</li>
</ul>
</li>
<li>
<p>Please refresh the page if it says:  <em>Please click here to continue to download OpenVPN Connect.
You will be automatically connected after the installation has finished.</em></p>
</li>
<li>
<p>Download the user-locked profile.
<span style="display:block;text-align:center"><img src="../../../img/vpn_cloud_1.png" alt="VPN HomePage"></span></p>
</li>
<li>
<p>Install a VPN client that supports DNS settings such as Visocity.</p>
</li>
</ol>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">brew cask install viscosity
</code></pre></div><ol start="5">
<li>
<p>Open the Viscosity application or your preferred VPN client and go to settings/preferences.</p>
</li>
<li>
<p>Click + to import the profile you downloaded from the VPN server on the step 1
<span style="display:block;text-align:center"><img src="../../../img/vpn_cloud_2.png" alt="Viscosity Profile Add"></span></p>
</li>
<li>
<p>After your profile is imported, select to edit the entry, go to Networking tab and update the DNS settings.</p>
<ul>
<li>Select for the Mode to be <code>Split DNS</code>.</li>
<li>As a Server IP put: <code>10.247.4.47</code> which is VPN&rsquo;s server IP.</li>
<li>In Domains put: <code>cloud.mattermost.com</code>, this will split traffic for those domains
<span style="display:block;text-align:center"><img src="../../../img/vpn_cloud_3_new.png" alt="Viscosity VPN CIDR"></span></li>
</ul>
</li>
<li>
<p>After following these steps you should be able to connect to VPN and then to resolve private DNS entries.</p>
</li>
</ol>


                </div>
            </div>
        </div>
    </div>
    <footer class="text-center">
    <div class="container-fluid">
        <div class="footer__copyright">© Mattermost, Inc. All Rights Reserved.</div>
        <div class="footer__icons">
            <a href="https://www.facebook.com/Mattermost-2300985916642531/"><i class="fa fa-facebook"></i></a>
            <a href="https://twitter.com/mattermost"><i class="fa fa-twitter"></i></a>
            <a href="https://www.youtube.com/channel/UCNR05H72hi692y01bWaFXNA"><i class="fa fa-youtube"></i></a>
        </div>
    </div>
</footer>

</body>
</html>
