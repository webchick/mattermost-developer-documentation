<!DOCTYPE html>





<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> Plugin Helpers</title>
<meta name="viewport" content="width=device-width, initial-scale=1">   
<meta http-equiv="content-language" content="en-us" />



<link rel="canonical" href="../../../extend/plugins/helpers/">


<link rel="shortcut icon" type="image/png" href="../../../img/favicon-32x32.png" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet">


<link rel="stylesheet" href="../../../css/bootstrap.min.css">
<link rel="stylesheet" href="../../../css/tabs.css">
<link rel="stylesheet" href="../../../css/bar.css">
<link rel="stylesheet" href="../../../css/styles.css">
<link rel="stylesheet" href="../../../css/code.css">
<link rel="stylesheet" href="../../../css/note.css">


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="../../../js/tabs.js"></script>
<script src="../../../js/main.js"></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>
<script async src="//cdn.bizible.com/scripts/bizible.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-64458817-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-64458817-2');
</script>


<script type="text/javascript">
    (function() {
    var didInit = false;
    function initMunchkin() {
    if(didInit === false) {
    didInit = true;
    Munchkin.init('161-FBE-733');
    }
    }
    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
    initMunchkin();
    }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>


<script type="text/javascript" charset="utf-8">
    var _eiq = _eiq || [];
    var _engagio_settings = {
      accountId: "cb6a404b72e9141b70d1f82abc04db92b4e56238"
    };
    (function() {
      var ei = document.createElement('script'); ei.type = 'text/javascript'; ei.async = true;
      ei.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'web-analytics.engagio.com/js/ei.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ei, s);
    })();
  </script>

    </head>
<body>
    <header>
    <a href="../../../"><img src="../../../img/logo.svg" alt="Mattermost Logo" width="212px"></a>
    <div class="header__menu-toggle">
        <i class="fa fa-bars"></i>
    </div>
    <ul class="header__links--right">
        <li><a href="../../../">Home</a></li>
        
            
            
            
                
                    <li><a href="../../../contribute/getting-started">Contribute</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../integrate/getting-started">Integrate</a></li>
                
            
        
            
            
            
                
                    <li class="active"><a href="../../../extend/getting-started">Extend</a></li>
                
            
        
            
            
            
                
                    <li><a href="../../../blog">Blog</a></li>
                
            
        
            
            
            
                
                    <li><a href="https://docs.mattermost.com/">Admin Docs</a></li>
                
            
        
    </ul>
</header>




    <div id="wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-3 sidebar">
    <div class="sidebar__menu-toggle">
        Plugin Helpers
        <i class="fa fa-bars pull-right"></i>
    </div>
    <div class="row sidebar__links">
        
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../extend/getting-started/"> Getting Started</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../extend/customization/"> Customizing Mattermost</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/customization/server-build/"> Server Build (Team Edition)</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/customization/server-files/"> Server Files</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/customization/webapp/"> Web App</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                
                    
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-minus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="../../../extend/plugins/"> Plugins (Beta)</a>
                    
                </span>
                <ul class="sub-menu" style="display: block">
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/overview/"> Overview</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                            
                                <a href="../../../extend/plugins/server/"> Server Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                                <a class="item " href="../../../extend/plugins/server/hello-world/">Quick Start</a>
                            
                                <a class="item " href="../../../extend/plugins/server/reference/">Server Reference</a>
                            
                                <a class="item " href="../../../extend/plugins/server/ha/">High Availability</a>
                            
                                <a class="item " href="../../../extend/plugins/server/debugging/"></a>
                            
                                <a class="item " href="../../../extend/plugins/server/best-practices/">Best Practices</a>
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                            
                                <a href="../../../extend/plugins/webapp/"> Web App Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                                <a class="item " href="../../../extend/plugins/webapp/hello-world/">Quick Start</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/reference/">Web App Reference</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/actions/">Redux Actions</a>
                            
                                <a class="item " href="../../../extend/plugins/webapp/best-practices/">Design Best Practices</a>
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/manifest-reference/"> Manifest Reference</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/mobile/"> Mobile Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/example-plugins/"> Example Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/migration/"> Migrating Plugins</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/community_process/"> Process to Include Plugin on Community</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/community-plugin-marketplace/"> Community Plugins in the Marketplace</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="../../../extend/plugins/best-practices/"> Best Practices</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        
                            
                        

                        
                            
                        

                        <span class="item active">
                            <i class="sub-menu__toggle fa fa-minus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a class="active" href="../../../extend/plugins/helpers/"> Plugin Helpers</a></span>
                            
                        </span>
                        <ul class="sub-menu" style="display: block">
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="../../../extend/embed/"> Embed</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
        
    </div>
</div>

                <div class="col-lg-9 doc-content">
                    
<a href="https://github.com/mattermost/mattermost-developer-documentation/edit/master/site/content/extend/plugins/helpers.md" class="float-right edit-github">
    Edit on GitHub
</a>


                    <h1 class="mt-0 doc-title">
                        Plugin Helpers
                    </h1>
                    <p>The plugin architecture consists of an <a href="../../../extend/plugins/server/reference/#API">API</a>, <a href="../../../extend/plugins/server/reference/#Hooks">hooks</a>, and plugin helpers.</p>
<p>When a plugin invokes an API method, it makes an RPC call to the Mattermost server and waits for a response. When the Mattermost server invokes a hook method, it makes an RPC call to the plugin and waits for a response:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#09f;font-style:italic">// OnActivate is a hook called by the server when the plugin is started.
</span><span style="color:#09f;font-style:italic"></span><span style="color:#069;font-weight:bold">func</span> (p <span style="color:#555">*</span>Plugin) <span style="color:#c0f">OnActivate</span>() <span style="color:#078;font-weight:bold">error</span> {
    <span style="color:#09f;font-style:italic">// CreatePost is an API called by the plugin to create a post.
</span><span style="color:#09f;font-style:italic"></span>	post, err <span style="color:#555">:=</span> p.API.<span style="color:#c0f">CreatePost</span>(<span style="color:#555">&amp;</span>model.Post{<span style="color:#555">...</span>})
    <span style="color:#069;font-weight:bold">if</span> err <span style="color:#555">!=</span> <span style="color:#069;font-weight:bold">nil</span> {
        <span style="color:#069;font-weight:bold">return</span> err
    }

    <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">nil</span>
}
</code></pre></div><p>By contrast, a plugin helper is just Go code that wraps the existing API and hook methods without introducing any new RPC calls:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> (p <span style="color:#555">*</span>Plugin) <span style="color:#c0f">OnActivate</span>() <span style="color:#078;font-weight:bold">error</span> {
    <span style="color:#069;font-weight:bold">var</span> enabled <span style="color:#078;font-weight:bold">bool</span>

    <span style="color:#09f;font-style:italic">// KVGetJSON is a plugin helper that wraps KVGet to simplify reading JSON data.
</span><span style="color:#09f;font-style:italic"></span>    _, err <span style="color:#555">:=</span> p.Helpers.<span style="color:#c0f">KVGetJSON</span>(<span style="color:#c30">&#34;enabled&#34;</span>, enabled)
    <span style="color:#069;font-weight:bold">if</span> err <span style="color:#555">!=</span> <span style="color:#069;font-weight:bold">nil</span> {
        <span style="color:#069;font-weight:bold">return</span> err
    }

    <span style="color:#069;font-weight:bold">if</span> enabled {
        <span style="color:#09f;font-style:italic">// ...
</span><span style="color:#09f;font-style:italic"></span>    }
}
</code></pre></div><p>Although plugin helpers are defined in the <a href="https://godoc.org/github.com/mattermost/mattermost-server/plugin#Helpers">github.com/mattermost/mattermost-server/plugin</a> package, they aren&rsquo;t part of the RPC exchange with the Mattermost server. This distinction has a number of advantages:</p>
<ul>
<li>Compatibility with older Mattermost servers (so long as they support the underlying API and hooks).</li>
<li>Flexibility in adding new helpers without cluttering the RPC protocol and corresponding API documentation.</li>
<li>Potential for independent versioning to improve the helpers without breaking previously compiled plugins.</li>
</ul>
<h1 id="faq">FAQ&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#faq"></i></a> </h1>
<h2 id="when-should-i-write-a-plugin-helper">When should I write a plugin helper?&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#when-should-i-write-a-plugin-helper"></i></a> </h2>
<p>In general, always write a plugin helper when the functionality can be expressed using the existing API or hooks.</p>
<p>Even if this is not possible, consider whether the helper functionality naturally decomposes into smaller, general purpose API calls and hooks to enable future plugin helpers to build upon your changes.</p>
<h2 id="when-to-write-a-new-api-method-new-hook">When to write a new API method? New hook?&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#when-to-write-a-new-api-method-new-hook"></i></a> </h2>
<p>Don&rsquo;t be afraid to extend the API or hooks to support brand new functionality. Consider accepting an options struct instead of a list of parameters to simplify extending the API in the future:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#09f;font-style:italic">// GetUsers a list of users based on search options.
</span><span style="color:#09f;font-style:italic"></span>	<span style="color:#09f;font-style:italic">//
</span><span style="color:#09f;font-style:italic"></span>	<span style="color:#09f;font-style:italic">// Minimum server version: 5.10
</span><span style="color:#09f;font-style:italic"></span>	<span style="color:#c0f">GetUsers</span>(options <span style="color:#555">*</span>model.UserGetOptions) ([]<span style="color:#555">*</span>model.User, <span style="color:#555">*</span>model.AppError)
</code></pre></div><p>Old servers won&rsquo;t do anything with new, unrecognized fields, but also won&rsquo;t break if they are present. When adding new options that will only be supported by some Mattermost server versions, consider wrapping the functionality with a plugin helper to help plugin authors safely use the API.</p>
<h2 id="how-do-i-add-a-plugin-helper">How do I add a plugin helper?&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#how-do-i-add-a-plugin-helper"></i></a> </h2>
<p>To add a helper to the official <a href="https://godoc.org/github.com/mattermost/mattermost-server/plugin#Helpers">github.com/mattermost/mattermost-server/plugin</a> package:</p>
<ul>
<li>Extend the <a href="https://github.com/mattermost/mattermost-server/blob/master/plugin/helpers.go"><code>Helpers</code> interface</a> with the new method.</li>
<li>Add a new method to the concrete <code>HelpersImpl</code> struct in a new or existing <code>helpers_*</code> file:</li>
</ul>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> (p <span style="color:#555">*</span>HelpersImpl) <span style="color:#c0f">NewHelper</span>(param1 <span style="color:#078;font-weight:bold">string</span>) (<span style="color:#078;font-weight:bold">error</span>) {
        <span style="color:#09f;font-style:italic">// ...
</span><span style="color:#09f;font-style:italic"></span>        <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">nil</span>
}
</code></pre></div><ul>
<li>Ensure the documented minimum server version reflects the maximum of any API calls or hooks your helper relies upon.</li>
</ul>


                </div>
            </div>
        </div>
    </div>
    <footer class="text-center">
    <div class="container-fluid">
        <div class="footer__copyright">Â© Mattermost, Inc. All Rights Reserved.</div>
        <div class="footer__icons">
            <a href="https://www.facebook.com/Mattermost-2300985916642531/"><i class="fa fa-facebook"></i></a>
            <a href="https://twitter.com/mattermost"><i class="fa fa-twitter"></i></a>
            <a href="https://www.youtube.com/channel/UCNR05H72hi692y01bWaFXNA"><i class="fa fa-youtube"></i></a>
        </div>
    </div>
</footer>

</body>
</html>
